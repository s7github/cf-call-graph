<!-- This file displays two tabs to enter user values and uses ajax calls to retrieve data without loading the page -->
<!DOCTYPE html>
<html>
<head>
<title>Dependency Depth</title>
<style type="text/css">
  input[type='text'] {
    border: 0; 
    border-bottom: 1px solid #CCCCCC; 
    height: 22px;
  } 
  input[type='submit'] {
    border: 1px solid #999999; 
    border-radius: 5px; 
    padding: 5px; 
    background-color: #666666; 
    letter-spacing: 26.7px; 
    color: #FFFFFF; 
    font-weight: bold; 
    cursor: pointer; 
    cursor: hand; 
    margin-top: lOpx; 
  } 
  label { 
    font-weight: bold; 
    color: #333333; 
    margin-right: lOpx; 
  } 
  .dependency { 
    border-left: 1px solid #EFEEEE; 
  } .
  dependency>div { 
    margin: Spx; 
    margin-left: 20px; 
    padding-left: 5px; 
  } 
  .dependency .sp { 
    color: #993A33; 
  } 
  .dependency .variable { 
    color: #666633; 
  } 
  .aGet { 
    color: #009900; 
    font-size: 0.8em; 
    text-decoration: none; 
  } 
  .aHide { 
    color: #FF9900; 
    font-size: 0.8em; 
    text-decoration: none; 
  } 
  .aJavadoc { 
    font-weight: bold; 
    text-decoration: none; 
    color: #000000; 
  } 
  .hint { 
    color: #999999; 
    font-size: 0.8em; 
  } 
  .tabs { 
    margin: 0; 
    padding: 0; 
    padding-bottom: 5px; 
  } 
  .tabs .tabActive { 
    background-color: #609AAF; 
    border-top: 1px solid #DDDDDD; 
  } 
  .tabs .tabActive a { 
    color: #FFFFFF; 
  } 
  .tabs li { 
    display: inline; 
    padding: 5px; 
  } 
  .tabs a { 
    text-decoration: none; 
    color: #000000; 
    outline: none; 
  } 
  #tabContents { 
    border-left: 1px solid #AAAAAA; 
    border-top: 1px solid #AAAAAA; 
    border-right: 1px solid #000000; 
    border-bottom: 1px solid #000000; 
    display: inline-block; 
    padding: 20px; 
    width: 880px; 
    height: 110px; 
  } 
</style> 

<script type="text/javascript"> 
  FORM_TYPES = { 
    BY_COMP   : 0   // By Component path and function name 
  , BY_TXCODE : 1   // By TxCode 
  } 
  
  function pageLoad () { 
    showFrmByComp(); 
  }
  
  function submitForComp () {
    getDependency('main', document.getElementById('mainComponent').value, document.getElementById('mainFunction').value); 
  } 
  
  function submitForTxCode () { 
    getServiceFuncDetails('main', document.getElementById('txcode').value);
  } 
  
  function showFrmByComp () { 
    document.getElementById('tabByComp').setAttribute("class", "tabActive"); 
    document.getElementById('tabByTxCode').removeAttribute("class"); 
    document.frmByTxCode.style.display = "none"; 
    document.frmByComp.style.display = ""; 
  } 

  function showFrmByTxCode () { 
    document.getElementById('tabByTxCode').setAttribute("class", "tabActive"); 
    document.getElementById('tabByComp').removeAttribute("class"); 
    document.frmByComp.style.display = "none"; 
    document.frmByTxCode.style.display = ""; 
  }
</script> 
</head> 

<body onload="pageLoad()">

<ul class="tabs">
  <li id="tabByComp"><a href="javascript:showFrmByComp()" accesskey="C">By Component / Function</a></li> 
  <li id="tabByTxCode"><a href="javascript:showFrmByTxCode()" accesskey="T">By TxCode</a></li> 
</ul> 

<div id="tabContents"> 
  <div id="divByComp"> 
  <form name="frmByComp" method="post" action="javascript:submitForComp();"> 
    <table> 
      <tr> 
        <td><label for="mainComponent">Component Relative Path</label></td> 
        <td>
          <input type="text" id="mainComponent" size="80" value="sites.backofficeportal" /> <span class="hint">(example: sites.backofficeportal)</span> 
        </td> 
      </tr> 
      <tr> 
        <td><label for="mainFunction">Function Name</label></td> 
        <td> 
          <input type="text" id="mainFunction" size="80" value="getPageByURL" /> <span class="hint">(example: getPageByURL)</span> 
        </td> 
      </tr> 
      <tr> 
        <td></td> 
        <td> 
          <input type="submit" value="Get Dependency" /> 
        </td> 
      </tr> 
    </table>
  </form>
  </div> 

  <div id="divByTxCode"> 
  <form name="frmByTxCode" method="post" action="javascript:submitForTxCode();"> 
    <table>
      <tr> 
        <td><label for="txcode">Service Function TxCode</label></td> 
        <td> 
          <input type="text" id="txcode" size="80" value="3801" /> <span class="hint">(example: 3801)</span> 
        </td>
      </tr>
      <tr>
        <td></td>
        <td>
          <input type="submit" value="Get Dependency" />
        </td>
      </tr>
    </table>
  </form>
  </div> 
</div> <br /><br />

<div id="div main" class="dependency"> &nbsp; </div> 

<script type="text/javascript"> 
  function getDependency (elemID, comp, func) { 
    var xmlHTTP; 
    
    if (windov.XMLHttpRequest) { 
      xmlHTTP = new XMLHttpRequest(); 
    } else { 
      xmlHTTP = new ActiveXObject("Microsoft.XMLHTTP"); 
    } 
    divElem = document.getElementById('div_' + elemID); 
    divElem.innerHTML = "Getting dependency..."; 
    xmlHTTP.onreadystatechange = function () { 
      if (xm1HTTP.readyState == 4 && xm1HTTP.status == 200) { 
        // Add sub function details to parent function 
        divElem.innerHTML = buildParentText(elemID, comp, func); 
        divElem.innerHTML = divElem.innerHTML + xmlHTTP.responseText; 
      } 
      xmIHTTP.open("GET", uss_OryDependency.cfm2comp=" + comp + "&func=" + func, true); xm1HTTP.send(); 
} 
function getServiceFuncDetails(elemID, txcode) { var xm1HTTP; var compFunc = ""; 
} 
if (window.XMLHttpRequest) ( xm1HTTP = new XMLHttpRequest(); ) else ( xm1HTTP = new ActiveXObjectrMicrosoft.XMLHTTP"); } 
divElem = document.getElementByIdycliv2 + elemID); divElem.innerHTML = "Getting service function details..."; xm1HTTP.onreadystatechange = function 0 ( if (xm1HTTP.readyState == 4 && xm1HTTP.status == 200) ( // Update component and function textbox values in other tab compFunc = xmIHTTP.responseText.split(9"); comp = compFunc[0]; func = compFunc[1]; document.getElementByIdymainComponent1).value = comp; document.getElementByIdymainFunction').value = func; divElem.innerHTML = "Getting dependency..."; submitForComp(); 
} 
} 
xmIHTTP.open("GET", uss_getServiceFunctionDetails.cfm2txcode=" + txcode, true); xm1HTTP.send(); 
function buildParentText(elemID, comp, func) ( // Javadoc link compPath = comp.replace0./g, "I"); compPath = compPath.replace(/Ablend)//, "9; comp = comp.replace(/Ablend)./, "9; hrefJavadoc = "http://ing2/ssharma/ws blend doc/blend/" + compPath + ".html#" + func 
htmlText = "Ca href=1"" + hrefJavadoc + "1" class=1"aJavadocl" target=1"_blankl">" + htmlText = htmlText + " Ca id=lua " + elemID + "1" class=1"aHidel" href=1"javascript: 
return htmlText; 
} 
function hideDependency(elemID, comp, func) ( // Reset div contents divElem = document.getElementByIdydiv2 + elemID); divElem.innerHTML = buildParentText(elemID, comp, func); // Enable get dependency link 
+ "0"; 
func + "C/a> (" + comp + ")"; hideDependency('" + elemID + "', '" + comp + "', '" + func + "')1r 

